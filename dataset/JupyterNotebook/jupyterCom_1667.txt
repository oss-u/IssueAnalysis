[
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/238524132",
    "html_url": "https://github.com/jupyter/notebook/issues/1667#issuecomment-238524132",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1667",
    "id": 238524132,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzODUyNDEzMg==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-09T11:18:37Z",
    "updated_at": "2016-08-09T11:18:37Z",
    "author_association": "MEMBER",
    "body": "Sorry to turf you back, but I'm pretty sure this is something to do with pandas in the first instance: it's using [ctypes code](https://github.com/pydata/pandas/blob/b7abef4949fb1ba7fd1004feba4f47ace7004282/pandas/util/clipboard.py#L62) to access the Windows clipboard, and ctypes is the top suspect whenever a Python process dies without an exception.\n\nHow are you starting Jupyter? I wonder if there's some difference in the environment if it's running without a console window.\n\nPing @jreback\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/238539790",
    "html_url": "https://github.com/jupyter/notebook/issues/1667#issuecomment-238539790",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1667",
    "id": 238539790,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzODUzOTc5MA==",
    "user": {
      "login": "jmarrec",
      "id": 5479063,
      "node_id": "MDQ6VXNlcjU0NzkwNjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5479063?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmarrec",
      "html_url": "https://github.com/jmarrec",
      "followers_url": "https://api.github.com/users/jmarrec/followers",
      "following_url": "https://api.github.com/users/jmarrec/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmarrec/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmarrec/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmarrec/subscriptions",
      "organizations_url": "https://api.github.com/users/jmarrec/orgs",
      "repos_url": "https://api.github.com/users/jmarrec/repos",
      "events_url": "https://api.github.com/users/jmarrec/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmarrec/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-09T12:37:58Z",
    "updated_at": "2016-08-09T12:38:05Z",
    "author_association": "NONE",
    "body": "to launch it I open cmd.exe, type `jupyter notebook <PathToFolder>`.\n\n(I'll let you guys decide if it's a pandas or a jupyter issue...)\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/238541548",
    "html_url": "https://github.com/jupyter/notebook/issues/1667#issuecomment-238541548",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1667",
    "id": 238541548,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzODU0MTU0OA==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-09T12:46:05Z",
    "updated_at": "2016-08-09T12:46:05Z",
    "author_association": "MEMBER",
    "body": "If you run this code directly in a notebook, does the kernel die? And if you split it up line by line, which line is it that makes the kernel die?\n\n``` python\nCF_UNICODETEXT = 13\nd = ctypes.windll\nd.user32.OpenClipboard(0)\nhandle = d.user32.GetClipboardData(CF_UNICODETEXT)\ndata = ctypes.c_wchar_p(handle).value\nd.user32.CloseClipboard()\n```\n\n(This is part of the code that I believe pandas is running when you call `read_clipboard()`.\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/238543012",
    "html_url": "https://github.com/jupyter/notebook/issues/1667#issuecomment-238543012",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1667",
    "id": 238543012,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzODU0MzAxMg==",
    "user": {
      "login": "jmarrec",
      "id": 5479063,
      "node_id": "MDQ6VXNlcjU0NzkwNjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5479063?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmarrec",
      "html_url": "https://github.com/jmarrec",
      "followers_url": "https://api.github.com/users/jmarrec/followers",
      "following_url": "https://api.github.com/users/jmarrec/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmarrec/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmarrec/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmarrec/subscriptions",
      "organizations_url": "https://api.github.com/users/jmarrec/orgs",
      "repos_url": "https://api.github.com/users/jmarrec/repos",
      "events_url": "https://api.github.com/users/jmarrec/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmarrec/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-09T12:52:11Z",
    "updated_at": "2016-08-09T12:59:20Z",
    "author_association": "NONE",
    "body": "It does die, on line `data = ctypes.c_wchar_p(handle).value`\n\nIn context: https://github.com/pydata/pandas/blob/f71537ab2561ab5727008095e9685966619fa7b9/pandas/util/clipboard.py#L67\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/238544019",
    "html_url": "https://github.com/jupyter/notebook/issues/1667#issuecomment-238544019",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1667",
    "id": 238544019,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzODU0NDAxOQ==",
    "user": {
      "login": "jmarrec",
      "id": 5479063,
      "node_id": "MDQ6VXNlcjU0NzkwNjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5479063?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmarrec",
      "html_url": "https://github.com/jmarrec",
      "followers_url": "https://api.github.com/users/jmarrec/followers",
      "following_url": "https://api.github.com/users/jmarrec/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmarrec/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmarrec/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmarrec/subscriptions",
      "organizations_url": "https://api.github.com/users/jmarrec/orgs",
      "repos_url": "https://api.github.com/users/jmarrec/repos",
      "events_url": "https://api.github.com/users/jmarrec/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmarrec/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-09T12:56:41Z",
    "updated_at": "2016-08-09T12:56:41Z",
    "author_association": "NONE",
    "body": "This works fine though:\n\n```\nimport win32clipboard\nwin32clipboard.OpenClipboard()\ndata = win32clipboard.GetClipboardData(win32clipboard.CF_UNICODETEXT)\nwin32clipboard.CloseClipboard()\n```\n\nso yeah, ctypes is seems to be the problem\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/255433431",
    "html_url": "https://github.com/jupyter/notebook/issues/1667#issuecomment-255433431",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1667",
    "id": 255433431,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NTQzMzQzMQ==",
    "user": {
      "login": "pbreach",
      "id": 8889265,
      "node_id": "MDQ6VXNlcjg4ODkyNjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8889265?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pbreach",
      "html_url": "https://github.com/pbreach",
      "followers_url": "https://api.github.com/users/pbreach/followers",
      "following_url": "https://api.github.com/users/pbreach/following{/other_user}",
      "gists_url": "https://api.github.com/users/pbreach/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pbreach/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pbreach/subscriptions",
      "organizations_url": "https://api.github.com/users/pbreach/orgs",
      "repos_url": "https://api.github.com/users/pbreach/repos",
      "events_url": "https://api.github.com/users/pbreach/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pbreach/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-21T17:52:56Z",
    "updated_at": "2016-10-21T17:52:56Z",
    "author_association": "NONE",
    "body": "Interestingly enough, I seem to run into this problem as well using the python console in PyCharm, which is using IPython 4.2.0. I will write the error manually here (after this happens I can't use the clipboard, not even for a screenshot):\n\n```\nTraceback (most recent call last):\n    File \"C:\\Users\\pbreach\\Anaconda3\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2885, in run_code\n        exec(code_obj, self.user_global_ns, self.user_ns)\n    File\"<ipython-input-5-9912851e21a2>\", line 1, in <module>\n        pd.Series(test).to_clipboard()\n    File\"C:\\Users\\pbreach\\Anaconda3\\lib\\site-packages\\pandas\\core\\generic.py\", line 1202, in to_clipboard\n        clipboard.to_clipboard(self, excel=excel, sep=sep, **kwargs)\n    File \"C:\\Users\\pbreach\\Anaconda3\\lib\\site-packages\\pandas\\io\\clipboard.py\", line 98, in to_clipboard\n        clipboard_set(object)\n    File \"C:\\Users\\pbreach\\Anaconda3\\lib\\site-packages\\pandas\\util\\clipboard.py\", line 85, in _copyWindows\n        ctypes.cdll.msvcrt.wcspy(ctypes.c_wchar_p(pchData), text)\nOSError: exception: access violation writing 0x0000000000000000\n```\n\nSo I think @jmarrec might be right in saying that it is a ctypes problem (at least it is the one throwing the error). I often get access violation errors with ctypes if I try to overwrite a file that is open in another process. It could be that the clipboard is being used by jupyter/ipython, and when pandas tries to access it, it causes the kernel to crash due to this error happening within jupyter/ipython process. Maybe it's possible that pandas could get around this or throw an error before it gets down to ctypes? \n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/255461729",
    "html_url": "https://github.com/jupyter/notebook/issues/1667#issuecomment-255461729",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1667",
    "id": 255461729,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NTQ2MTcyOQ==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-21T20:49:56Z",
    "updated_at": "2016-10-21T20:49:56Z",
    "author_association": "MEMBER",
    "body": "We do have some code to access the clipboard in IPython, but it isn't run unless you run `%paste`. I still think we're causing pandas' clipboard to hit some corner case that's exposing a bug there. 'access violation' sounds like a Windows equivalent of 'segmentation fault'.\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/260517994",
    "html_url": "https://github.com/jupyter/notebook/issues/1667#issuecomment-260517994",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1667",
    "id": 260517994,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDUxNzk5NA==",
    "user": {
      "login": "aravindsd",
      "id": 19371042,
      "node_id": "MDQ6VXNlcjE5MzcxMDQy",
      "avatar_url": "https://avatars.githubusercontent.com/u/19371042?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aravindsd",
      "html_url": "https://github.com/aravindsd",
      "followers_url": "https://api.github.com/users/aravindsd/followers",
      "following_url": "https://api.github.com/users/aravindsd/following{/other_user}",
      "gists_url": "https://api.github.com/users/aravindsd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aravindsd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aravindsd/subscriptions",
      "organizations_url": "https://api.github.com/users/aravindsd/orgs",
      "repos_url": "https://api.github.com/users/aravindsd/repos",
      "events_url": "https://api.github.com/users/aravindsd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aravindsd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-15T01:20:15Z",
    "updated_at": "2016-11-15T01:20:15Z",
    "author_association": "NONE",
    "body": "See Pandas documentation to use **read_clipboard** (Anaconda Package)\nIt seems pandas read_clipboard need optional dependencies which are not yet compatible with **python 3.5**. I guess that's hindrance for _**read_clipboard**_ \n\nhttp://pandas.pydata.org/pandas-docs/stable/install.html#optional-dependencies\n\n![image](https://cloud.githubusercontent.com/assets/19371042/20247366/58a93212-a9f0-11e6-8a5b-a22eb8ba036d.png)\n\nDoesn't have any issue in Python 3.4 (Anaconda Package)\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/260519700",
    "html_url": "https://github.com/jupyter/notebook/issues/1667#issuecomment-260519700",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1667",
    "id": 260519700,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDUxOTcwMA==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-15T01:30:36Z",
    "updated_at": "2016-11-15T01:30:36Z",
    "author_association": "MEMBER",
    "body": "Looking at the code, I don't think it needs any of those on Windows, which is the case for this bug report. In any case, `xclip` and `xsel` are external commands, so they shouldn't depend on the Python version.\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/349397585",
    "html_url": "https://github.com/jupyter/notebook/issues/1667#issuecomment-349397585",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1667",
    "id": 349397585,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0OTM5NzU4NQ==",
    "user": {
      "login": "ayhanfuat",
      "id": 6108349,
      "node_id": "MDQ6VXNlcjYxMDgzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6108349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ayhanfuat",
      "html_url": "https://github.com/ayhanfuat",
      "followers_url": "https://api.github.com/users/ayhanfuat/followers",
      "following_url": "https://api.github.com/users/ayhanfuat/following{/other_user}",
      "gists_url": "https://api.github.com/users/ayhanfuat/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ayhanfuat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ayhanfuat/subscriptions",
      "organizations_url": "https://api.github.com/users/ayhanfuat/orgs",
      "repos_url": "https://api.github.com/users/ayhanfuat/repos",
      "events_url": "https://api.github.com/users/ayhanfuat/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ayhanfuat/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-05T18:32:39Z",
    "updated_at": "2017-12-05T18:33:02Z",
    "author_association": "NONE",
    "body": "This seems to be resolved by one of the updates of pandas. After upgrading to 0.20.3 I got it working in both Jupyter Notebook and Jupyter QtConsole.",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/349434225",
    "html_url": "https://github.com/jupyter/notebook/issues/1667#issuecomment-349434225",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1667",
    "id": 349434225,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0OTQzNDIyNQ==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-05T20:39:28Z",
    "updated_at": "2017-12-05T20:39:28Z",
    "author_association": "MEMBER",
    "body": "Thanks @ayhanfuat ",
    "performed_via_github_app": null
  }
]
