First of all thank you for all your hard work with the notebook.

I have a very weird problem with Jupyter that nobody else seem to have reported so far. Specifically whenever I click on a cell (no matter if it's empty or not) it's height decreases making half of the line covered.

![jupyter](https://cloud.githubusercontent.com/assets/18163728/16255351/1bd8e63a-3884-11e6-8731-8766931de72b.png)

I'm using Python 3.5, Arch Linux and view the notebook in newest Firefox. I have a 4K screen so perhaps it's because of this?

Any help would be appreciated, maybe there is a simple solution rather than modifying CSS files.

Many thanks!
That is definitely a bug!I think I have seen this before, but I'm not sure what causes it.

If you have updated Firefox recently, make sure you restart it - there are all sorts of weird things that can occur if Firefox has been updated but not restarted.
Thank you both for the prompt replies.

I have actually had this issue from the very start, consistently, regardless of Firefox version. It does not go away with restarts or updates. I also have the same issue on my notebook (again with Arch Linux and 4K screen).

Not sure if anything like Gnome windows scaling or Firefox plugins might cause it? Really like the notebook so really keen to make it work. Happy to help with pinpointing the cause as best as I can.
Firefox plugins is a possibility. Can you try it with Firefox in safe mode (disables plugins)
Did some quick testing - the issue is not caused by the add-ons but the but the appearance theme. Specifically this one;
https://github.com/gnome-integration-team/firefox-gnome/

Is this something that should be dealt with on the Notebook side or the theme side? I presume some themes might cause it while others won't.
Hmmm. I'm surprised that a theme can affect how stuff inside a page looks. I don't really know who to talk to about that.
I see. Well thanks very much for your help. If anyone else has a similar problem at least it will be clear what is the cause. I will just look for alternative theme I can use that will not affect the cells.

Keep up the great work with the notebook.
Yes, that's a known CodeMirror issue where firefox bady report the measurement of things on the DOM. 

It pops up regularly, and depending on system can (sometime) be solved by : resizing the window, zooming in then out, focusing the cell...etc. It's unfortunate, and sadly there is not much we can do . 
Funnily enough, I encountered a similar issue but on Chrome.
![screen shot 2016-08-19 at 2 11 30 pm](https://cloud.githubusercontent.com/assets/1518713/17824448/dec5b79e-6616-11e6-9126-171a33724236.png). For me it usually happens for long running notebooks (think days). Closing the tab and reopening it usually fixes things.
Hmm, I have also seen this in JupyterLab recently, may be new bugs showing up...

Targeting to 4.3 so we can investigate...
Has anyone investigated, and/or does anyone have time to investigate before we do 4.3, which I'd like to release fairly soon?

Ping @ellisonbg 
We've updated to CodeMirror 5.21 recently, which could possibly contain a fix, but I haven't been able to reproduce this one in a while. Generally these height-measuring problems are in (and fixed in) CodeMirror.I see that the CM update (#1921) was already backported. So I'm going to punt this to 5.0. Maybe it will be already fixed.I've seen this in Chrome too, on non-Jupyter apps using CodeMirror. Have started seeing it less across the ecosystem again, definitely a measurement issue that was pervasive for a bit.I encountered a similar issue on Chrome, and this issue can also occur on safari and firefox in my MBP. But oddly enough, when I pulled out the mouse from laptop and used trackpad only, this issue can not occur. When I used mouse again, this issue occurred again. 
<img width="924" alt="2016-12-25 5 27 20" src="https://cloud.githubusercontent.com/assets/11803276/21470560/6ec77780-cac9-11e6-8b1d-39531a395051.png">
I have the same issue on Chrome. I don't believe I'm using Code Mirror anywhere. This was a notebook that showed this appearance upon open. (screenshot attached). 
<img width="771" alt="screen shot 2017-01-27 at 5 32 39 pm" src="https://cloud.githubusercontent.com/assets/13428836/22392464/bd2091da-e4b6-11e6-9bd1-246c4caa2a8a.png">
@cassiusoat's note about mouse and trackpad might be an important clue. macOS can hide scroll bars until scrolling starts. I believe the default (certainly an option) is to hide by default when using a gesture-enabled trackpad, but always show scroll bars if a mouse is in use.

If CodeMirror is measuring assuming a scroll bar would always be present, but it isn't, we could get this behavior (cutoff of the width of one scroll bar). To enable this behavior explicitly:

    System Preferences > General > Show scroll bars: When scrolling

It's possible it's specifically an interacting with the 'When scrolling' setting. It's also possible that it's related to switching back and forth in the "Automatically..." state, where CM makes a decision based on prior state, but doesn't update if that state changes.

<img width="658" alt="screen shot 2017-02-01 at 15 39 43" src="https://cloud.githubusercontent.com/assets/151929/22511283/833589e8-e895-11e6-8bcf-55e5f7a1ab4f.PNG">
@jaykinghorn what versions of:

- notebook
- browser(s)
- OS

If you are using macOS, can you share your `General > Show scroll bars` setting? Does changing it have any effect?

Every text area in the notebook is CodeMirror, so it's always involved somehow.The truncated cells seem to happen after I close my laptop and come back to
it after a period of time. I’ll do more testing to see if it always happen
after the computer sleeps, or whether it is intermittent.

I had my scroll bar setting at the default “Automatically based on mouse or
trackpad.” When I change this setting to Always, it restores the correct
height of the cells.

I’m using:
Version 4.2.1 with Python 2.7.12 |Anaconda custom (x86_64)| (default, Jul 2
2016, 17:43:17) [GCC 4.2.1 (Based on Apple Inc. build 5658) (LLVM build
2336.11.00)]

Browser is Chrome Version 55.0.2883.95 and Mac OS 10.11.4.

Good to know about Code Mirror.

Thanks for your help.

Jay


On February 1, 2017 at 8:00:46 AM, Min RK (notifications@github.com) wrote:

@jaykinghorn <https://github.com/jaykinghorn> what versions of:

   - notebook
   - browser(s)
   - OS

If you are using macOS, can you share your General > Show scroll bars
setting? Does changing it have any effect?

Every text area in the notebook is CodeMirror, so it's always involved
somehow.

—
You are receiving this because you were mentioned.
Reply to this email directly, view it on GitHub
<https://github.com/jupyter/notebook/issues/1560#issuecomment-276679309>,
or mute the thread
<https://github.com/notifications/unsubscribe-auth/AMzoZEPYPhdFi_A9Mrja6ohmhO2MoVe5ks5rYJ4dgaJpZM4I7ahl>
.
We need to be able to predictably reproduce this. Based on @rgbkrk's comment, this might be an issue with CodeMirror (possibly https://github.com/codemirror/CodeMirror/issues/3129, https://github.com/codemirror/CodeMirror/issues/3679), but without a reproducible demo, we are not likely to get help from the CM team. I think this is either a browser or CodeMirror bug (or both) related to the changing size of scrollbars depending on context. I'm not sure there is much we can do about it except try to narrow it down and report upstream.Bumping to 5.1 as it sounds like we don't have a reliable reproduction or a good idea of a possible fix, and it may well not even be in our code.FWIW, I do see this exact same issue in JupyterLab master sometimes. Can't
reproduce it though...

On Tue, Feb 14, 2017 at 6:17 AM, Thomas Kluyver <notifications@github.com>
wrote:

> Bumping to 5.1 as it sounds like we don't have a reliable reproduction or
> a good idea of a possible fix, and it may well not even be in our code.
>
> —
> You are receiving this because you were mentioned.
> Reply to this email directly, view it on GitHub
> <https://github.com/jupyter/notebook/issues/1560#issuecomment-279718330>,
> or mute the thread
> <https://github.com/notifications/unsubscribe-auth/AABr0JNgMbq2x5cRnjh3gEFstYhED0eAks5rcbdygaJpZM4I7ahl>
> .
>



-- 
Brian E. Granger
Associate Professor of Physics and Data Science
Cal Poly State University, San Luis Obispo
@ellisonbg on Twitter and GitHub
bgranger@calpoly.edu and ellisonbg@gmail.com
@minrk : I had the same issue in safari on a mac. Searching this issue online leads me here. But when I set the "Show scroll bars" to "Always", seems this issue would disappear. Setting this to the other two options would immediately make this issue back. Then after setting back to "Always", I have to use the up and down arrows to flip through all cells and the folded part will unfold. Afterwards it seems everything is OK. 

$ jupyter --version
4.2.0
$ sw_vers 
ProductName:	Mac OS X
ProductVersion:	10.11.6
@ChaoYue Thanks for this! This is helpful. The presumed CodeMirror bug was patched in 4.3.2, so it shouldn't be an issue if you upgrade to the current version (5.0.0). I'm going to close this as it now seems resolved...I'm having this issue only recently after upgrading jupyter (currently 4.3.0 via anaconda).  I'm not using CodeMirror (to my knowledge; are we talking about [CodeMirror.net](http://codemirror.net/)??).

The issue is resolved by switching the cell type away from code (e.g. to markdown) then back again.
I cannot reproduce the issue consistently.

An additional issue (likely related?) is that some cells have *extra space* on the bottom, that can't be removed.  Haven't been able to get a screen-capture of that yet.

Jupyter: 4.3.0
OSX: 10.12.5
Chrome: 58.0.3029.110 (64-bit)

![ipy_glitch_1](https://cloud.githubusercontent.com/assets/3839265/26755839/1cfddf98-4864-11e7-9e39-c17160328af6.gif)
@lzkelley CodeMirror refers to CodeMirro javascript library that the notebook uses to provide syntax highlighting and other code authoring features. @rgbkrk reports seeing this in other browsers using other non-Jupyter apps which supports the hypothesis that it's related to CodeMirror. I'll re-open this as it's a legitimate bug and should be resolved once we figure out the cause of it... 🤔> @rgbkrk reports seeing this in other browsers using other non-Jupyter apps which supports the hypothesis that it's related to CodeMirror.

The most important feature these apps all share is that there are usually more than one codemirror instance on the page when this happens.Hi, 

I run jupyter notebook (4.2.3-4) on Debian "sid" with Google Chrome, Firefox, and Chromium, and they all exhibit the same problem: 

- When ever a current cell gets focus (cursor moves in, click, typing), the height of the cell increases by 85px.  

I see that by running the DOM inspector.  For what it is worth, I use Gnome-shell, not that I think it matters. Also, this applies whether I use a physical mouse or touchpad.

It seems to be a sub-DIV of a DIV with class `CodeMirror-vscrollbar` which has it's height changed - it's not the class but the element directly in a STYLE attribute. 
```
<div class=CodeMirror-vscrollbar>
  <div style="height: x; width: y"></div> <!-- This is the div that changes height -->
</div>
```
Breaking  attribute changes on the sub-DIV, I see the change happens in `codemirror.js` around line 426 (in my version) of the function NativeScrollbars.update:
```
NativeScrollbars.prototype = copyObj({
    update: function(measure) {
      var needsH = measure.scrollWidth > measure.clientWidth + 1; // false
      var needsV = measure.scrollHeight > measure.clientHeight + 1; // true
      var sWidth = measure.nativeBarWidth; // 0

      if (needsV) { // needsV is true
        this.vert.style.display = "block";
        this.vert.style.bottom = needsH ? sWidth + "px" : "0";
        var totalHeight = measure.viewHeight - (needsH ? sWidth : 0); //measure.viewheight=888,
        // A bug in IE8 can cause this value to be negative, so guard it.
        this.vert.firstChild.style.height =
          Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + "px";//This is what seems to grow
      } else {
        this.vert.style.display = "";
        this.vert.firstChild.style.height = "0";
      }
```
It's a rather annoying bug that makes the note-book entirely useless. 

Yours,

Christian@cholmcc Have you tested notebook 5.0.0? I'm curious if this codemirror bug (?) has been resolved...Bumped to backlog as we're still not sure what the cause is, and it doesn't seem likely we can fix it for 5.1.Sorry I didn't get back sooner (vacation time)

I found the cause - the installation of libjs-codemirror (via Debian
package) was incomplete - specifically the links

  /usr/share/javascript/codemirror/codemirror.css
  /usr/share/javascript/codemirror/codemirror.js

was broken.  I found this on two independent machines, so my guess is
something was wrong with the package. Reinstalling the package (same
version) reinstated the links and all is dandy.

I guess you can close this from my side at least. Thanks.

In case you're interested: I found the problem by using the built-in
debugger tools of the browser - specifically I say 404 errors on the two
files mentioned.

Yours,

Christian


On Thu, Jul 13, 2017 at 4:50 PM, Thomas Kluyver <notifications@github.com>
wrote:

> Bumped to backlog as we're still not sure what the cause is, and it
> doesn't seem likely we can fix it for 5.1.
>
> —
> You are receiving this because you were mentioned.
> Reply to this email directly, view it on GitHub
> <https://github.com/jupyter/notebook/issues/1560#issuecomment-315101319>,
> or mute the thread
> <https://github.com/notifications/unsubscribe-auth/AG3ncFvd3j0YooOeWEt50bKrUnBPknNrks5sNi65gaJpZM4I7ahl>
> .
>



-- 

 ___  |  Christian Holm Christensen
  |_| |  -------------------------------------------------------------
    | |  Address: Niels Bohr Institute
     _|           Blegdamsvej 17
    _|            DK-2100 Copenhagen O
 ____|   Web:     http://cern.ch/cholm
 | |     Cell:    +45 24 61 85 91
@cholmcc Nice investigatory work! I can't reproduce this myself, but I think that your findings will be helpful for others should they encounter it. I am going to close this and mark as "reference."I have the exact same issue in Jupyter (as part of anaconda2) on Chrome on OSX. Does anyone have a hint how to check the version of CodeMirror and/or how to update it? It doesn't seem to be managed by Conda,...CodeMirror is a Javascript package, and it's bundled with the notebook. There'll be a notebook 5.5 release soon with the latest codemirror.@takluyver Does this mean it has been **fixed** in the codemirror version which comes with 5.5, or that you figure it **might be fixed** in that version and you're not sure?Same issue here! Occurs every time I plug/unplug the USB adapter or the charging cable.
For reference: I have a MacBookPro running macOS High Sierra 10.13.6
Using notebook server version 5.5.0
Running the following python version:
Python 3.6.5 |Anaconda, Inc.| (default, Apr 26 2018, 08:42:37) 
[GCC 4.2.1 Compatible Clang 4.0.1 (tags/RELEASE_401/final)]

I also have a partial workaround for the following situation:
1. Plug the mouse or plug/unplug the power cable;
2. Input cells get trimmed, as reported previously
3. If I click in the little space between an input cell and the previous output cell above, the input cell returns to its normal size.

This doesn't work in case I unplug the mouse. If I do step 3 with the trackpad, the input cells remain trimmed.
That is so bizarre. I can't imagine how plugging in the power cable or a USB device would affect how the notebook is being rendered! Please share any other observations that might help us hunt this down.This is a brilliant observation by @tufixm - plugging in a mouse on macOS does change the rendering of scrollable areas - moreover, it does it in a different way across firefox and chrome. Here are some miscellaneous text areas in firefox on wikipedia, for example. Presumably the same issue arises in codemirror/jupyter.

![without mouse](https://user-images.githubusercontent.com/21740/47826760-c3ee2b00-ddcd-11e8-9edf-2fb8b0f8025e.png)
![with mouse](https://user-images.githubusercontent.com/21740/47826761-c486c180-ddcd-11e8-8df3-735deac80ba2.png)
I am never moving my laptop ever again. All peripherals must stay the same.@danagilliann Thanks for sharing this observation. This is clearly an issue affecting Chrome and Firefox and not restricted to the notebook or codemirror but apparently all textarea elements. Any more info would be much appreciated 👍I can confirm this bug occurred for me when using  *Jupyter Lab* (version _0.34.12_) with an external monitor (different resolution than my Mac) and disconnecting the external monitor (removing the HDMI made the browser screen go to the laptop monitor and the height of cells was incorrect). 

Fixing the bug was simple: by zooming out to 90% and zooming back in to 100% with Chrome `Ctrl` + `-` / `+`

edit: Issue https://github.com/jupyter/notebook/issues/1467I would often find this happened to my notebooks running in Safari overnight.  Based on this thread I found a reproducible cause: If "Show Scroll bars" is set to "Automatically based on mouse or trackpad" in the General System Preferences panel, AND bluetooth is turned off (disconnecting my BT mouse) you can visibly see many of the Mac OSX windows resize slightly (causing the cell height issue).  If you turn off the "scroll bar setting" to be "Always" the problem appears to go away because the windows aren't slightly resized by the OS on BT peripheral (probably mouse) connect/disconnect.  My overnight issue was possibly that my BT mouse was going to sleep or BT went into some low-power mode.  Touching a cell number for a cell with the mouse causes the cell to resize and display properly when it has been misaligned. (Jupyter Notebook: 4.4.0, Mac 10.14.4, Safari 12.1 14607.1.40.1.4)This is certainly happening in Chrome, too. So I think we can conclude that this is caused by the browser resizing. This can be caused by an auto-hiding scrollbar, switching between internal/external display, and I've also seen it occur when screen sharing. 

I'm not sure if we can do anything about it. Once a cell is clicked/focused, it resizes itself and the height is corrected, so _perhaps_ each cell/codemirror instance can listen for browser resize events and then update themselves (or whatever happens when it's focused).> I can confirm this bug occurred for me when using _Jupyter Lab_ (version _0.34.12_) with an external monitor (different resolution than my Mac) and disconnecting the external monitor (removing the HDMI made the browser screen go to the laptop monitor and the height of cells was incorrect).
> 
> Fixing the bug was simple: by zooming out to 90% and zooming back in to 100% with Chrome `Ctrl` + `-` / `+`
> 
> edit: Issue #1467

Works on Safari too> @cholmcc Have you tested notebook 5.0.0? I'm curious if this codemirror bug (?) has been resolved...

I'm running jupyter notebook 5.7.8 on chrome in windows10 and still have the half height cell CodeMirror issue. To me the cell displayed correctly until I clicked the cell and start to edit, that's when the cell displays with less height. > The truncated cells seem to happen after I close my laptop and come back to it after a period of time. I’ll do more testing to see if it always happen after the computer sleeps, or whether it is intermittent. I had my scroll bar setting at the default “Automatically based on mouse or trackpad.” When I change this setting to Always, it restores the correct height of the cells. I’m using: Version 4.2.1 with Python 2.7.12 |Anaconda custom (x86_64)| (default, Jul 2 2016, 17:43:17) [GCC 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00)] Browser is Chrome Version 55.0.2883.95 and Mac OS 10.11.4. Good to know about Code Mirror. Thanks for your help. Jay On February 1, 2017 at 8:00:46 AM, Min RK (notifications@github.com) wrote: @jaykinghorn <https://github.com/jaykinghorn> what versions of: - notebook - browser(s) - OS If you are using macOS, can you share your General > Show scroll bars setting? Does changing it have any effect? Every text area in the notebook is CodeMirror, so it's always involved somehow. — You are receiving this because you were mentioned. Reply to this email directly, view it on GitHub <[#1560 (comment)](https://github.com/jupyter/notebook/issues/1560#issuecomment-276679309)>, or mute the thread <https://github.com/notifications/unsubscribe-auth/AMzoZEPYPhdFi_A9Mrja6ohmhO2MoVe5ks5rYJ4dgaJpZM4I7ahl> .

Changing MAcOS settings to 'Always' solved the issue for meHi, Is there any proposed solution here? I tried using some background Theme mods and it solved the problem for me.  

Sent from my iPhone

> On Feb 12, 2020, at 1:10 AM, Gryllos Prokopis <notifications@github.com> wrote:
> 
> ﻿
> Hi, Is there any proposed solution here?
> 
> —
> You are receiving this because you commented.
> Reply to this email directly, view it on GitHub, or unsubscribe.
> Hi, Is there any proposed solution here?

If you are working on MacOS try changing the scroll bar setting to 'Always' as suggested here https://github.com/jupyter/notebook/issues/1560#issuecomment-276675479
It worked for me. 
I am using Firefox version 76.0.1(64 bit) on MacOS. 10.15.5I'm seeing this on Linux Ubuntu, Firefox 85. Needing to add an extra blank line at the bottom of each cell basically makes it unusable :-(. It does work in Chromium.

I had these versions installed:
```
jupyter (1.0.0)
jupyter-client (5.2.4)
jupyter-console (6.0.0)
jupyter-core (4.4.0)
```

So just used pip3 to update them, to this:

```
jupyter (1.0.0)
jupyter-client (6.1.11)
jupyter-console (6.2.0)
jupyter-core (4.7.1)
jupyterlab-pygments (0.1.2)
jupyterlab-widgets (1.0.0)
```

Which unfortunately made no difference.

```Python 3.6.9 (default, Oct  8 2020, 12:12:24) 
Type 'copyright', 'credits' or 'license' for more information
IPython 7.16.1 -- An enhanced Interactive Python. Type '?' for help.```

I'm only using one screen, and changing mouse made no difference. Zoom in and out makes no difference.
