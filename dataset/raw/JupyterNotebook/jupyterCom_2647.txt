[
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/314417152",
    "html_url": "https://github.com/jupyter/notebook/issues/2647#issuecomment-314417152",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/2647",
    "id": 314417152,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxNDQxNzE1Mg==",
    "user": {
      "login": "minrk",
      "id": 151929,
      "node_id": "MDQ6VXNlcjE1MTkyOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minrk",
      "html_url": "https://github.com/minrk",
      "followers_url": "https://api.github.com/users/minrk/followers",
      "following_url": "https://api.github.com/users/minrk/following{/other_user}",
      "gists_url": "https://api.github.com/users/minrk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minrk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minrk/subscriptions",
      "organizations_url": "https://api.github.com/users/minrk/orgs",
      "repos_url": "https://api.github.com/users/minrk/repos",
      "events_url": "https://api.github.com/users/minrk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minrk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-11T11:39:04Z",
    "updated_at": "2017-07-11T11:39:04Z",
    "author_association": "MEMBER",
    "body": "If you shutdown and reopen the individual notebook document, it should get the new definition. It doesn't need to restart the notebook server. Alternately, if you have more than one kernelspec, changing the kernel to another kernelspec and then back should also trigger reloading the spec.",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/409470378",
    "html_url": "https://github.com/jupyter/notebook/issues/2647#issuecomment-409470378",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/2647",
    "id": 409470378,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwOTQ3MDM3OA==",
    "user": {
      "login": "kevcampb",
      "id": 1244107,
      "node_id": "MDQ6VXNlcjEyNDQxMDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1244107?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kevcampb",
      "html_url": "https://github.com/kevcampb",
      "followers_url": "https://api.github.com/users/kevcampb/followers",
      "following_url": "https://api.github.com/users/kevcampb/following{/other_user}",
      "gists_url": "https://api.github.com/users/kevcampb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kevcampb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kevcampb/subscriptions",
      "organizations_url": "https://api.github.com/users/kevcampb/orgs",
      "repos_url": "https://api.github.com/users/kevcampb/repos",
      "events_url": "https://api.github.com/users/kevcampb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kevcampb/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-01T06:58:20Z",
    "updated_at": "2018-08-01T06:58:20Z",
    "author_association": "NONE",
    "body": "This doesn't seem to be the case. \r\n\r\nWith a kernel config file ~/.ipython/kernels/datascience_local/kernel.json\r\n```\r\n{\r\n  \"argv\": [\"~/.virtualenvs/datascience_local/bin/python\", \"-m\", \"IPython.kernel\",\r\n  \"-f\", \"{connection_file}\"],\r\n  \"display_name\": \"Datascience - local\",\r\n  \"language\": \"python\"\r\n}\r\n```\r\n\r\nIn this situation, the python path does not work as jupyter will not resolve ~ to the user homedir. The full path needs specified.\r\n\r\nAttempting to use the kernel in a notebook will show kernel error, and the traceback given is as follows\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.5/dist-packages/tornado/web.py\", line 1592, in _execute\r\n    result = yield result\r\n  File \"/usr/local/lib/python3.5/dist-packages/tornado/gen.py\", line 1133, in run\r\n    value = future.result()\r\n  File \"/usr/lib/python3.5/asyncio/futures.py\", line 274, in result\r\n    raise self._exception\r\n  File \"/usr/local/lib/python3.5/dist-packages/tornado/gen.py\", line 1141, in run\r\n    yielded = self.gen.throw(*exc_info)\r\n  File \"/usr/local/lib/python3.5/dist-packages/notebook/services/sessions/handlers.py\", line 73, in post\r\n    type=mtype))\r\n  File \"/usr/local/lib/python3.5/dist-packages/tornado/gen.py\", line 1133, in run\r\n    value = future.result()\r\n  File \"/usr/lib/python3.5/asyncio/futures.py\", line 274, in result\r\n    raise self._exception\r\n  File \"/usr/local/lib/python3.5/dist-packages/tornado/gen.py\", line 1141, in run\r\n    yielded = self.gen.throw(*exc_info)\r\n  File \"/usr/local/lib/python3.5/dist-packages/notebook/services/sessions/sessionmanager.py\", line 79, in create_session\r\n    kernel_id = yield self.start_kernel_for_session(session_id, path, name, type, kernel_name)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tornado/gen.py\", line 1133, in run\r\n    value = future.result()\r\n  File \"/usr/lib/python3.5/asyncio/futures.py\", line 274, in result\r\n    raise self._exception\r\n  File \"/usr/local/lib/python3.5/dist-packages/tornado/gen.py\", line 1141, in run\r\n    yielded = self.gen.throw(*exc_info)\r\n  File \"/usr/local/lib/python3.5/dist-packages/notebook/services/sessions/sessionmanager.py\", line 92, in start_kernel_for_session\r\n    self.kernel_manager.start_kernel(path=kernel_path, kernel_name=kernel_name)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tornado/gen.py\", line 1133, in run\r\n    value = future.result()\r\n  File \"/usr/lib/python3.5/asyncio/futures.py\", line 274, in result\r\n    raise self._exception\r\n  File \"/usr/local/lib/python3.5/dist-packages/tornado/gen.py\", line 326, in wrapper\r\n    yielded = next(result)\r\n  File \"/usr/local/lib/python3.5/dist-packages/notebook/services/kernels/kernelmanager.py\", line 160, in start_kernel\r\n    super(MappingKernelManager, self).start_kernel(**kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/jupyter_client/multikernelmanager.py\", line 110, in start_kernel\r\n    km.start_kernel(**kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/jupyter_client/manager.py\", line 259, in start_kernel\r\n    **kw)\r\n  File \"/usr/local/lib/python3.5/dist-packages/jupyter_client/manager.py\", line 204, in _launch_kernel\r\n    return launch_kernel(kernel_cmd, **kw)\r\n  File \"/usr/local/lib/python3.5/dist-packages/jupyter_client/launcher.py\", line 128, in launch_kernel\r\n    proc = Popen(cmd, **kwargs)\r\n  File \"/usr/lib/python3.5/subprocess.py\", line 947, in __init__\r\n    restore_signals, start_new_session)\r\n  File \"/usr/lib/python3.5/subprocess.py\", line 1551, in _execute_child\r\n    raise child_exception_type(errno_num, err_msg)\r\nFileNotFoundError: [Errno 2] No such file or directory: '~/.virtualenvs/datascience_local/bin/python'\r\n```\r\nCorrecting the kernel.json file has no effect. Restarting the user hub, logging out as the user, restarting the kernel, deleting and creating a new notebook, the error persists. Same for changing to a working kernel and then changing back.\r\n\r\nCreating a new kernel datascience_local2/kernel.json with the correct python path does work. The new kernel appears in the list, and you can change to that kernel and use it successfully.\r\n\r\nRestarting the main jupyterhub process will resolve the issue, and the kernel changes will finally be picked up. That's obviously non-ideal though.\r\n\r\n```\r\nkevin.campbell@jupyter-stg:~> /usr/local/bin/jupyter  --version\r\n4.4.0\r\nkevin.campbell@jupyter-stg:~> /usr/local/bin/jupyterhub  --version\r\n0.9.1\r\nkevin.campbell@jupyter-stg:~> /usr/local/bin/jupyter notebook --version\r\n5.6.0\r\n```",
    "performed_via_github_app": null
  }
]
