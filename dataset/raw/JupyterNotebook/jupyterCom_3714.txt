[
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/399893735",
    "html_url": "https://github.com/jupyter/notebook/pull/3714#issuecomment-399893735",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/3714",
    "id": 399893735,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTg5MzczNQ==",
    "user": {
      "login": "minrk",
      "id": 151929,
      "node_id": "MDQ6VXNlcjE1MTkyOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minrk",
      "html_url": "https://github.com/minrk",
      "followers_url": "https://api.github.com/users/minrk/followers",
      "following_url": "https://api.github.com/users/minrk/following{/other_user}",
      "gists_url": "https://api.github.com/users/minrk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minrk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minrk/subscriptions",
      "organizations_url": "https://api.github.com/users/minrk/orgs",
      "repos_url": "https://api.github.com/users/minrk/repos",
      "events_url": "https://api.github.com/users/minrk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minrk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-25T09:42:08Z",
    "updated_at": "2018-06-25T09:42:08Z",
    "author_association": "MEMBER",
    "body": "I think option 2 is probably the right one. A simple check for `localhost` or `.is_loopback` on the bind ip, and only enable by default if this is the case.\r\n\r\n> Can we reliably know whether the server is listening on a public IP?\r\n\r\nNot strictly (e.g. in docker, it always looks like a public server), but I think it's probably the right thing to do to disable this check if the bind IP is anything other than a very simple `localhost` or `127.*` address.",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/399927087",
    "html_url": "https://github.com/jupyter/notebook/pull/3714#issuecomment-399927087",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/3714",
    "id": 399927087,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTkyNzA4Nw==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-25T12:00:46Z",
    "updated_at": "2018-06-25T12:00:46Z",
    "author_association": "MEMBER",
    "body": "OK, I've added a dynamic default, using `socket.getaddrinfo()` if `self.ip` is not an IP address. Is that OK to run on startup, or should we hardcode a check against `'localhost'` (and maybe `localhost6` - I don't know if this is the same on all platforms).",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/401310272",
    "html_url": "https://github.com/jupyter/notebook/pull/3714#issuecomment-401310272",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/3714",
    "id": 401310272,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMTMxMDI3Mg==",
    "user": {
      "login": "minrk",
      "id": 151929,
      "node_id": "MDQ6VXNlcjE1MTkyOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minrk",
      "html_url": "https://github.com/minrk",
      "followers_url": "https://api.github.com/users/minrk/followers",
      "following_url": "https://api.github.com/users/minrk/following{/other_user}",
      "gists_url": "https://api.github.com/users/minrk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minrk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minrk/subscriptions",
      "organizations_url": "https://api.github.com/users/minrk/orgs",
      "repos_url": "https://api.github.com/users/minrk/repos",
      "events_url": "https://api.github.com/users/minrk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minrk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-29T10:03:02Z",
    "updated_at": "2018-06-29T10:03:02Z",
    "author_association": "MEMBER",
    "body": "I realized this will require changes to the default jupyterhub configuration (I disable this behavior entirely in https://github.com/jupyterhub/jupyterhub/pull/2015), which uses localhost by default for single-user servers, and it got me thinking that maybe the `Host` header isn't the right thing to use here. Maybe we should be checking the direct ip of the connection? That way, if it's being proxied the notebook is relinquishing responsibility for this kind of check, and only checks that the connection comes *directly* from localhost, not what the connecting browser *thinks* is localhost.\r\n\r\nI believe this is available in tornado as `self.address[0]`. What do you think?",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/401469280",
    "html_url": "https://github.com/jupyter/notebook/pull/3714#issuecomment-401469280",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/3714",
    "id": 401469280,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMTQ2OTI4MA==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-29T20:44:58Z",
    "updated_at": "2018-06-29T20:44:58Z",
    "author_association": "MEMBER",
    "body": "As I understand it, checking the client IP doesn't give you any protection against DNS rebinding, because the connection is being made from localhost in that case. I believe the only way to check that is to look at the domain name that the browser thinks it's talking to.\r\n\r\nDo we need any coordination to avoid problems for Jupyterhub? E.g. we could have this feature present but off by default for a while to give people a chance to get on a newer Jupyterhub before the check is used.",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/401813350",
    "html_url": "https://github.com/jupyter/notebook/pull/3714#issuecomment-401813350",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/3714",
    "id": 401813350,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMTgxMzM1MA==",
    "user": {
      "login": "minrk",
      "id": 151929,
      "node_id": "MDQ6VXNlcjE1MTkyOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minrk",
      "html_url": "https://github.com/minrk",
      "followers_url": "https://api.github.com/users/minrk/followers",
      "following_url": "https://api.github.com/users/minrk/following{/other_user}",
      "gists_url": "https://api.github.com/users/minrk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minrk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minrk/subscriptions",
      "organizations_url": "https://api.github.com/users/minrk/orgs",
      "repos_url": "https://api.github.com/users/minrk/repos",
      "events_url": "https://api.github.com/users/minrk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minrk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-02T13:57:02Z",
    "updated_at": "2018-07-02T13:57:02Z",
    "author_association": "MEMBER",
    "body": "> checking the client IP doesn't give you any protection against DNS rebinding\r\n\r\nGood point! I forgot that was the point of this whole thing.\r\n\r\n> Do we need any coordination to avoid problems for Jupyterhub?\r\n\r\nIt's not a disaster. I think we'll get 0.9.1 out this week, which will have this disabled. Worst case is users on earlier Hub versions with latest notebook can set this flag in their Spawner config.",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/401925126",
    "html_url": "https://github.com/jupyter/notebook/pull/3714#issuecomment-401925126",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/3714",
    "id": 401925126,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMTkyNTEyNg==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-02T20:31:08Z",
    "updated_at": "2018-07-02T20:31:08Z",
    "author_association": "MEMBER",
    "body": "OK, great. I think I'm happy with this, except that I don't know if it's reasonable to call `socket.getaddrinfo()` at startup if we're asked to listen on a hostname rather than an IP address.",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/402080834",
    "html_url": "https://github.com/jupyter/notebook/pull/3714#issuecomment-402080834",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/3714",
    "id": 402080834,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMjA4MDgzNA==",
    "user": {
      "login": "minrk",
      "id": 151929,
      "node_id": "MDQ6VXNlcjE1MTkyOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minrk",
      "html_url": "https://github.com/minrk",
      "followers_url": "https://api.github.com/users/minrk/followers",
      "following_url": "https://api.github.com/users/minrk/following{/other_user}",
      "gists_url": "https://api.github.com/users/minrk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minrk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minrk/subscriptions",
      "organizations_url": "https://api.github.com/users/minrk/orgs",
      "repos_url": "https://api.github.com/users/minrk/repos",
      "events_url": "https://api.github.com/users/minrk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minrk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-03T09:40:39Z",
    "updated_at": "2018-07-03T09:40:39Z",
    "author_association": "MEMBER",
    "body": "The getaddrinfo works for me with `socket.gethostname()`, so I think it should be fine.",
    "performed_via_github_app": null
  }
]
