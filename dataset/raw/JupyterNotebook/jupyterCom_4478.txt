[
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/481742545",
    "html_url": "https://github.com/jupyter/notebook/issues/4478#issuecomment-481742545",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/4478",
    "id": 481742545,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MTc0MjU0NQ==",
    "user": {
      "login": "kevin-bates",
      "id": 22599560,
      "node_id": "MDQ6VXNlcjIyNTk5NTYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/22599560?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kevin-bates",
      "html_url": "https://github.com/kevin-bates",
      "followers_url": "https://api.github.com/users/kevin-bates/followers",
      "following_url": "https://api.github.com/users/kevin-bates/following{/other_user}",
      "gists_url": "https://api.github.com/users/kevin-bates/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kevin-bates/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kevin-bates/subscriptions",
      "organizations_url": "https://api.github.com/users/kevin-bates/orgs",
      "repos_url": "https://api.github.com/users/kevin-bates/repos",
      "events_url": "https://api.github.com/users/kevin-bates/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kevin-bates/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-10T15:36:26Z",
    "updated_at": "2019-04-10T15:36:26Z",
    "author_association": "MEMBER",
    "body": "It appears you're running into an instance of a missing sticky bit such that your `XDG_RUNTIME_DIR` (`/run/user/1132`) is getting cleared after some amount of time.  As a result, subsequent attempts to start a kernel, fail.  This is described here https://github.com/jupyter/jupyter_client/issues/199 - leading to a solution in jupyter_client 5.2.  The sticky bit is applied to Jupyter's runtime dir - which is the `jupyter` sub-directory to `/run/user/1132` when the first kernel is started. Try updating jupyter_client to an applicable version >= 5.2.0.",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/482095805",
    "html_url": "https://github.com/jupyter/notebook/issues/4478#issuecomment-482095805",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/4478",
    "id": 482095805,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MjA5NTgwNQ==",
    "user": {
      "login": "MarkusThill",
      "id": 8896197,
      "node_id": "MDQ6VXNlcjg4OTYxOTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8896197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarkusThill",
      "html_url": "https://github.com/MarkusThill",
      "followers_url": "https://api.github.com/users/MarkusThill/followers",
      "following_url": "https://api.github.com/users/MarkusThill/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarkusThill/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarkusThill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarkusThill/subscriptions",
      "organizations_url": "https://api.github.com/users/MarkusThill/orgs",
      "repos_url": "https://api.github.com/users/MarkusThill/repos",
      "events_url": "https://api.github.com/users/MarkusThill/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarkusThill/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-11T12:34:45Z",
    "updated_at": "2019-04-11T12:34:45Z",
    "author_association": "NONE",
    "body": "Thanks for the fast reply. I updated jupyter_client to 6.0.0, but the problem remains. After some time the directory `/run/user/1132/` is removed. Can it have to do with the `screen`, in which I start jupyter?",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/482121100",
    "html_url": "https://github.com/jupyter/notebook/issues/4478#issuecomment-482121100",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/4478",
    "id": 482121100,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MjEyMTEwMA==",
    "user": {
      "login": "kevin-bates",
      "id": 22599560,
      "node_id": "MDQ6VXNlcjIyNTk5NTYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/22599560?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kevin-bates",
      "html_url": "https://github.com/kevin-bates",
      "followers_url": "https://api.github.com/users/kevin-bates/followers",
      "following_url": "https://api.github.com/users/kevin-bates/following{/other_user}",
      "gists_url": "https://api.github.com/users/kevin-bates/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kevin-bates/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kevin-bates/subscriptions",
      "organizations_url": "https://api.github.com/users/kevin-bates/orgs",
      "repos_url": "https://api.github.com/users/kevin-bates/repos",
      "events_url": "https://api.github.com/users/kevin-bates/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kevin-bates/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-11T13:47:22Z",
    "updated_at": "2019-04-11T13:47:22Z",
    "author_association": "MEMBER",
    "body": "Hmm - the [latest version of jupyter_client is 5.2.4](https://pypi.org/project/jupyter_client/).  When you say `6.0.0`, is this from a build of the master branch?\r\n\r\nThis issue is more predicated on the existence of the `XDG_RUNTIME_DIR` environment variable.  When present, Jupyter will use that value as the prefix to its runtime location.  The operating system has its own _automatic cleanup_ mechanism for these files (thus their removal).  There are couple ways you can circumvent this - although the appropriate jupyter_client \"should\" correct this.  So, assuming you have a sufficient jupyter_client installed and still see the issue, you could try the following...\r\n1. Set env `JUPYTER_RUNTIME_DIR` to some directory you have control over and restart Notebook.\r\n2. unset env `XDG_RUNTIME_DIR` and restart Notebook.  I would not recommend unsetting this variable in a permanent fashion, since it may affect other applications. However, unsetting it as part of a startup script of Notebook is probably fine.  Technically, that script should restore the value in case the shell is reused after Notebook runs.  In this case, jupyter will use its default mechanisms and the kernel-<kid>.json file will likely windup in subdirectory under the Notebook user's home directory.\r\n\r\nIf the issue persists, you should probably open an issue in the jupyter_client repo - or reopen one of the previously fixed issues. ",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/482130409",
    "html_url": "https://github.com/jupyter/notebook/issues/4478#issuecomment-482130409",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/4478",
    "id": 482130409,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MjEzMDQwOQ==",
    "user": {
      "login": "MarkusThill",
      "id": 8896197,
      "node_id": "MDQ6VXNlcjg4OTYxOTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8896197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarkusThill",
      "html_url": "https://github.com/MarkusThill",
      "followers_url": "https://api.github.com/users/MarkusThill/followers",
      "following_url": "https://api.github.com/users/MarkusThill/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarkusThill/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarkusThill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarkusThill/subscriptions",
      "organizations_url": "https://api.github.com/users/MarkusThill/orgs",
      "repos_url": "https://api.github.com/users/MarkusThill/repos",
      "events_url": "https://api.github.com/users/MarkusThill/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarkusThill/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-11T14:10:28Z",
    "updated_at": "2019-04-11T14:10:28Z",
    "author_association": "NONE",
    "body": "Thanks again for the fast reply. Yes, I have a build of the master branch. That is why the version is 6.0.0. \r\nI will try your two suggestions and report later, if they worked. \r\n\r\nI noticed that the sticky bit is set on `/run/user/1132/jupyter` when I start jupyter (`drwx-----T`). Did I understand you correctly that if the bit is set, the OS should not automatically remove the directory?\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/482138543",
    "html_url": "https://github.com/jupyter/notebook/issues/4478#issuecomment-482138543",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/4478",
    "id": 482138543,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MjEzODU0Mw==",
    "user": {
      "login": "kevin-bates",
      "id": 22599560,
      "node_id": "MDQ6VXNlcjIyNTk5NTYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/22599560?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kevin-bates",
      "html_url": "https://github.com/kevin-bates",
      "followers_url": "https://api.github.com/users/kevin-bates/followers",
      "following_url": "https://api.github.com/users/kevin-bates/following{/other_user}",
      "gists_url": "https://api.github.com/users/kevin-bates/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kevin-bates/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kevin-bates/subscriptions",
      "organizations_url": "https://api.github.com/users/kevin-bates/orgs",
      "repos_url": "https://api.github.com/users/kevin-bates/repos",
      "events_url": "https://api.github.com/users/kevin-bates/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kevin-bates/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-11T14:30:27Z",
    "updated_at": "2019-04-11T14:30:27Z",
    "author_association": "MEMBER",
    "body": "Thanks for the update.  Yes, that's my understanding based on the readings/resolutions of the previous issues in jupyter_client.  There was some thought about whether the [bit was actually required at the file level instead](https://github.com/jupyter/jupyter_client/issues/199#issuecomment-346844724), but we know from the error message, given the failure is during creation of the file, that the directory is no longer present, so I'd be surprised that's the issue.\r\n\r\nHmm - another question would be - when does the jupyter sub-directory get created in the first place and could that code also be used as part of the creation of the connection file?  I believe this file is only needed at initial kernel startup.  This would then tolerate timed-out removals.",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/482520803",
    "html_url": "https://github.com/jupyter/notebook/issues/4478#issuecomment-482520803",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/4478",
    "id": 482520803,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MjUyMDgwMw==",
    "user": {
      "login": "MarkusThill",
      "id": 8896197,
      "node_id": "MDQ6VXNlcjg4OTYxOTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8896197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarkusThill",
      "html_url": "https://github.com/MarkusThill",
      "followers_url": "https://api.github.com/users/MarkusThill/followers",
      "following_url": "https://api.github.com/users/MarkusThill/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarkusThill/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarkusThill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarkusThill/subscriptions",
      "organizations_url": "https://api.github.com/users/MarkusThill/orgs",
      "repos_url": "https://api.github.com/users/MarkusThill/repos",
      "events_url": "https://api.github.com/users/MarkusThill/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarkusThill/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-12T10:15:24Z",
    "updated_at": "2019-04-12T10:15:24Z",
    "author_association": "NONE",
    "body": "As far as I can see, the `jupyter` sub-directory is only created when I start jupyter (and it does not exist yet). I also think that the connection file is only needed for the kernel start-up, since my already running kernels do not cause any problems and still work after many days. So it could make sense to check the existance of the `jupyter` sub-directory when creating the connection file.\r\nI also tried setting the sticky bit manually to `/run/user/1132/jupyter` and `/run/user/1132`, but it does not really help, the directory `/run/user/1132` is simply removed after some time. \r\nFor the moment I will stick to your first suggestion, to set env `JUPYTER_RUNTIME_DIR`, which works perfectly fine.\r\nThanks for your help!!!",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/482596724",
    "html_url": "https://github.com/jupyter/notebook/issues/4478#issuecomment-482596724",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/4478",
    "id": 482596724,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MjU5NjcyNA==",
    "user": {
      "login": "kevin-bates",
      "id": 22599560,
      "node_id": "MDQ6VXNlcjIyNTk5NTYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/22599560?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kevin-bates",
      "html_url": "https://github.com/kevin-bates",
      "followers_url": "https://api.github.com/users/kevin-bates/followers",
      "following_url": "https://api.github.com/users/kevin-bates/following{/other_user}",
      "gists_url": "https://api.github.com/users/kevin-bates/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kevin-bates/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kevin-bates/subscriptions",
      "organizations_url": "https://api.github.com/users/kevin-bates/orgs",
      "repos_url": "https://api.github.com/users/kevin-bates/repos",
      "events_url": "https://api.github.com/users/kevin-bates/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kevin-bates/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-12T14:32:11Z",
    "updated_at": "2019-04-12T14:32:11Z",
    "author_association": "MEMBER",
    "body": "Yeah, even if the sticky bit was required at the file level, it only keeps the directory present if there's another kernel running after the XDG expiration.  So until the directory is always created-if-not-present, I think this would be an issue.\r\n\r\nGlad you're moving forward - thanks for all the experimenting!",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/486684190",
    "html_url": "https://github.com/jupyter/notebook/issues/4478#issuecomment-486684190",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/4478",
    "id": 486684190,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjY4NDE5MA==",
    "user": {
      "login": "kevin-bates",
      "id": 22599560,
      "node_id": "MDQ6VXNlcjIyNTk5NTYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/22599560?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kevin-bates",
      "html_url": "https://github.com/kevin-bates",
      "followers_url": "https://api.github.com/users/kevin-bates/followers",
      "following_url": "https://api.github.com/users/kevin-bates/following{/other_user}",
      "gists_url": "https://api.github.com/users/kevin-bates/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kevin-bates/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kevin-bates/subscriptions",
      "organizations_url": "https://api.github.com/users/kevin-bates/orgs",
      "repos_url": "https://api.github.com/users/kevin-bates/repos",
      "events_url": "https://api.github.com/users/kevin-bates/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kevin-bates/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-25T13:58:21Z",
    "updated_at": "2019-04-25T13:58:21Z",
    "author_association": "MEMBER",
    "body": "+1 to get this PR merged and drop use of XDG_RUNTIME_DIR: https://github.com/jupyter/jupyter_core/pull/143",
    "performed_via_github_app": null
  }
]
