[
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/260011686",
    "html_url": "https://github.com/jupyter/notebook/issues/1888#issuecomment-260011686",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1888",
    "id": 260011686,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDAxMTY4Ng==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-11T17:37:52Z",
    "updated_at": "2016-11-11T17:37:52Z",
    "author_association": "MEMBER",
    "body": "Is there anything unusual about that notebook (e.g. is it particularly big)? Can you find anything that changed yesterday that could have affected this (e.g. updates installed)?\n\nThe code that handler is using to retrieve the notebook is [here](https://github.com/jupyter/notebook/blob/2bbaaa5cde5c2dc1a42042db02c6cc4025a24cee/notebook/services/contents/filemanager.py#L331) if you want to break down exactly which operation is slow. \n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/260012835",
    "html_url": "https://github.com/jupyter/notebook/issues/1888#issuecomment-260012835",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1888",
    "id": 260012835,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDAxMjgzNQ==",
    "user": {
      "login": "dodysw",
      "id": 507130,
      "node_id": "MDQ6VXNlcjUwNzEzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/507130?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dodysw",
      "html_url": "https://github.com/dodysw",
      "followers_url": "https://api.github.com/users/dodysw/followers",
      "following_url": "https://api.github.com/users/dodysw/following{/other_user}",
      "gists_url": "https://api.github.com/users/dodysw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dodysw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dodysw/subscriptions",
      "organizations_url": "https://api.github.com/users/dodysw/orgs",
      "repos_url": "https://api.github.com/users/dodysw/repos",
      "events_url": "https://api.github.com/users/dodysw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dodysw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-11T17:43:19Z",
    "updated_at": "2016-11-11T17:43:19Z",
    "author_association": "NONE",
    "body": "There is nothing unusual. This happened too even when creating new (empty) notebook. Browsing the file tree in Jupyter is fine. Opening terminal is fine. The reason I'm thinking it's the environment is because it didn't happen in my other Linux VMs not managed by corporate. \n\nThanks for pointing the entry point, will get back to this thread my discoveries after putting print statements...\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/260016574",
    "html_url": "https://github.com/jupyter/notebook/issues/1888#issuecomment-260016574",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1888",
    "id": 260016574,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDAxNjU3NA==",
    "user": {
      "login": "dodysw",
      "id": 507130,
      "node_id": "MDQ6VXNlcjUwNzEzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/507130?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dodysw",
      "html_url": "https://github.com/dodysw",
      "followers_url": "https://api.github.com/users/dodysw/followers",
      "following_url": "https://api.github.com/users/dodysw/following{/other_user}",
      "gists_url": "https://api.github.com/users/dodysw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dodysw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dodysw/subscriptions",
      "organizations_url": "https://api.github.com/users/dodysw/orgs",
      "repos_url": "https://api.github.com/users/dodysw/repos",
      "events_url": "https://api.github.com/users/dodysw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dodysw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-11T17:59:47Z",
    "updated_at": "2016-11-11T17:59:47Z",
    "author_association": "NONE",
    "body": "It was stucked at [this line](https://github.com/jupyter/nbformat/blob/1eaa2e89381ec9a345bc39e4727ea1b86218733d/nbformat/sign.py#L252)\n\nreally surprising, why would checking if an object is null would take a long time. Continuing with digging....\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/260020301",
    "html_url": "https://github.com/jupyter/notebook/issues/1888#issuecomment-260020301",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1888",
    "id": 260020301,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDAyMDMwMQ==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-11T18:16:42Z",
    "updated_at": "2016-11-11T18:16:42Z",
    "author_association": "MEMBER",
    "body": "Getting `self.db` for the first time will run [this function](https://github.com/jupyter/nbformat/blob/1eaa2e89381ec9a345bc39e4727ea1b86218733d/nbformat/sign.py#L132) which opens an sqlite database. We've had some issues with sqlite when on an NFS filesystem - is your home dir on NFS? Is `~/.local/share/jupyter/nbsignatures.db` getting big?\n\nYou can bypass the file access for this database by configuring `NotebookNotary.db_file=':memory:'`. This will mean all notebooks are untrusted, but if they load quickly, that's an improvement.\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/260023331",
    "html_url": "https://github.com/jupyter/notebook/issues/1888#issuecomment-260023331",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1888",
    "id": 260023331,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDAyMzMzMQ==",
    "user": {
      "login": "dodysw",
      "id": 507130,
      "node_id": "MDQ6VXNlcjUwNzEzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/507130?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dodysw",
      "html_url": "https://github.com/dodysw",
      "followers_url": "https://api.github.com/users/dodysw/followers",
      "following_url": "https://api.github.com/users/dodysw/following{/other_user}",
      "gists_url": "https://api.github.com/users/dodysw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dodysw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dodysw/subscriptions",
      "organizations_url": "https://api.github.com/users/dodysw/orgs",
      "repos_url": "https://api.github.com/users/dodysw/repos",
      "events_url": "https://api.github.com/users/dodysw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dodysw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-11T18:31:07Z",
    "updated_at": "2016-11-11T18:31:07Z",
    "author_association": "NONE",
    "body": "Yes you are correct! The home dir is an NFS mount. I was thinking Jupyter only uses ~/.jupyter to store user files. The moment I saw the .db was an sqlite file and your reply came that it was stored in homedir, it is a problem. Pretty sure sqlite doesn't work in NFS.\n\nThanks for helping me with this and the work around. We can close this issue.\n\nTldr. If home directory is an NFS mount, Jupyter may not work as expected.\n\nOn November 11, 2016 12:16:44 PM CST, Thomas Kluyver notifications@github.com wrote:\n\n> Getting `self.db` for the first time will run [this\n> function](https://github.com/jupyter/nbformat/blob/1eaa2e89381ec9a345bc39e4727ea1b86218733d/nbformat/sign.py#L132)\n> which opens an sqlite database. We've had some issues with sqlite when\n> on an NFS filesystem - is your home dir on NFS? Is\n> `~/.local/share/jupyter/nbsignatures.db` getting big?\n> \n> You can bypass the file access for this database by configuring\n> `NotebookNotary.db_file=':memory:'`. This will mean all notebooks are\n> untrusted, but if they load quickly, that's an improvement.\n> \n> ## \n> \n> You are receiving this because you authored the thread.\n> Reply to this email directly or view it on GitHub:\n> https://github.com/jupyter/notebook/issues/1888#issuecomment-260020301\n\n## \n\nSent from my Android device with K-9 Mail. Please excuse my brevity.\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/260024995",
    "html_url": "https://github.com/jupyter/notebook/issues/1888#issuecomment-260024995",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1888",
    "id": 260024995,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDAyNDk5NQ==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-11T18:39:20Z",
    "updated_at": "2016-11-11T18:39:20Z",
    "author_association": "MEMBER",
    "body": "We are planning to move away from sqlite for the notebook signatures database - I'm hoping to have some time to work on that in the couple of days. #1782 will track that.\n\nWe also use an sqlite database for IPython history; you may have some trouble with that too. To avoid that, look up `HistoryAccessor.hist_file` in [this page](http://ipython.readthedocs.io/en/stable/config/options/terminal.html).\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/260123464",
    "html_url": "https://github.com/jupyter/notebook/issues/1888#issuecomment-260123464",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/1888",
    "id": 260123464,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDEyMzQ2NA==",
    "user": {
      "login": "dodysw",
      "id": 507130,
      "node_id": "MDQ6VXNlcjUwNzEzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/507130?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dodysw",
      "html_url": "https://github.com/dodysw",
      "followers_url": "https://api.github.com/users/dodysw/followers",
      "following_url": "https://api.github.com/users/dodysw/following{/other_user}",
      "gists_url": "https://api.github.com/users/dodysw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dodysw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dodysw/subscriptions",
      "organizations_url": "https://api.github.com/users/dodysw/orgs",
      "repos_url": "https://api.github.com/users/dodysw/repos",
      "events_url": "https://api.github.com/users/dodysw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dodysw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-12T13:55:25Z",
    "updated_at": "2016-11-12T13:55:25Z",
    "author_association": "NONE",
    "body": "You were right again on the IPython history, it was having the same problem too when starting IPython. Also, the size of sqlite db in my case is 380KB for IPython history.sqlite, and 63KB for nbsignatures.db.\n\nJust to summarize the work arounds related to issues with Jupyter/IPython hanging/not-responding/stuck for 5 minutes when starting/opening/creating notebook due to sqlite DB file on NFS mount:\n- IPython: pass `--HistoryAccessor.hist_file` parameter when running IPython to a different path on a non-NFS mount e.g. `ipython --HistoryManager.hist_file=/tmp/ipython_hist.sqlite`, or set environment variable `IPYTHONDIR` to a non-NFS mount directory. E.g. `export IPYTHONDIR=/opt/appserver/sandbox/.ipython`\n- Jupyter: Adding NotebookNotary.db_file=':memory:' in `$HOME/.jupyter/jupyter_notebook_config.py` which creates the sqlite database in memory, so will not persist when Jupyter process restarted. Or moving data directory to non-NFS partition by setting `JUPYTER_DATA_DIR` environment variable before running Jupyter. E.g. \n  `export JUPYTER_DATA_DIR=/opt/appserver/sandbox/.local/share`\n\nThe following work around from [the documentation](https://github.com/jupyter/notebook/blob/715a6c02db0f6ad639d63e4f6fdff0cc63b91ec2/docs/source/security.rst) doesn't seem to work, when starting Jupyter, log said data_dir was not recognized as a valid configuration:\n\n> To share a signatures database among users, you can configure:\n> \n> c.NotebookNotary.data_dir = \"/path/to/signature_dir\"\n> to specify a non-default path to the SQLite database (of notebook hashes, essentially). \n\nI think that instruction should be replaced with setting JUPYTER_DATA_DIR environment variable instead (from looking at [this line code](https://github.com/jupyter/jupyter_core/blob/master/jupyter_core/paths.py#L51)).\n",
    "performed_via_github_app": null
  }
]
