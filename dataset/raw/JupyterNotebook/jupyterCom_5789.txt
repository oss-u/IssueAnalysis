[
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/702686842",
    "html_url": "https://github.com/jupyter/notebook/pull/5789#issuecomment-702686842",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/5789",
    "id": 702686842,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMjY4Njg0Mg==",
    "user": {
      "login": "mueslo",
      "id": 847751,
      "node_id": "MDQ6VXNlcjg0Nzc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/847751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mueslo",
      "html_url": "https://github.com/mueslo",
      "followers_url": "https://api.github.com/users/mueslo/followers",
      "following_url": "https://api.github.com/users/mueslo/following{/other_user}",
      "gists_url": "https://api.github.com/users/mueslo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mueslo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mueslo/subscriptions",
      "organizations_url": "https://api.github.com/users/mueslo/orgs",
      "repos_url": "https://api.github.com/users/mueslo/repos",
      "events_url": "https://api.github.com/users/mueslo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mueslo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-02T11:43:08Z",
    "updated_at": "2020-10-02T11:53:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "I don't think the failed test has anything to do with my change, as the code does not call _check_pid_win32 (check_pid is only used in notebookapp.py)",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/702800120",
    "html_url": "https://github.com/jupyter/notebook/pull/5789#issuecomment-702800120",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/5789",
    "id": 702800120,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMjgwMDEyMA==",
    "user": {
      "login": "kevin-bates",
      "id": 22599560,
      "node_id": "MDQ6VXNlcjIyNTk5NTYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/22599560?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kevin-bates",
      "html_url": "https://github.com/kevin-bates",
      "followers_url": "https://api.github.com/users/kevin-bates/followers",
      "following_url": "https://api.github.com/users/kevin-bates/following{/other_user}",
      "gists_url": "https://api.github.com/users/kevin-bates/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kevin-bates/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kevin-bates/subscriptions",
      "organizations_url": "https://api.github.com/users/kevin-bates/orgs",
      "repos_url": "https://api.github.com/users/kevin-bates/repos",
      "events_url": "https://api.github.com/users/kevin-bates/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kevin-bates/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-02T15:28:42Z",
    "updated_at": "2020-10-02T15:28:42Z",
    "author_association": "MEMBER",
    "body": "Hi @mueslo - thank you for contributing.  I agree that the test failure is likely not related - let's not worry about at the moment.\r\n\r\nI must say that I'm not completely enamored with this approach as it does seem to lead to COM monikers and co-initialization, etc. (This has triggered flashbacks to 25 years ago. :smile: )  I also ran into this [SO question](https://stackoverflow.com/questions/38860185/python-cant-import-wmi-under-special-circumstance) and am a little uneasy about this biting us in various scenarios that will inevitably creep up.\r\n\r\nI'm wondering if you might be getting bit by this [leaked handle issue](https://github.com/jupyter/notebook/issues/4862) that was posted a while back.  Would you be willing to try out that suggested change first?",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/702821523",
    "html_url": "https://github.com/jupyter/notebook/pull/5789#issuecomment-702821523",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/5789",
    "id": 702821523,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMjgyMTUyMw==",
    "user": {
      "login": "mueslo",
      "id": 847751,
      "node_id": "MDQ6VXNlcjg0Nzc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/847751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mueslo",
      "html_url": "https://github.com/mueslo",
      "followers_url": "https://api.github.com/users/mueslo/followers",
      "following_url": "https://api.github.com/users/mueslo/following{/other_user}",
      "gists_url": "https://api.github.com/users/mueslo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mueslo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mueslo/subscriptions",
      "organizations_url": "https://api.github.com/users/mueslo/orgs",
      "repos_url": "https://api.github.com/users/mueslo/repos",
      "events_url": "https://api.github.com/users/mueslo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mueslo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-02T16:09:15Z",
    "updated_at": "2020-10-02T16:10:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "I tried it, but the problem is that I currently cannot reproduce the issue I was facing where `ctypes.windll.kernel32.OpenProcess(1,0,pid)` would return a handle despite no such process existing (any more). If it is due to the leaked handle, it is not quite clear in which constellation this problem occurs...",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/702823607",
    "html_url": "https://github.com/jupyter/notebook/pull/5789#issuecomment-702823607",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/5789",
    "id": 702823607,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMjgyMzYwNw==",
    "user": {
      "login": "kevin-bates",
      "id": 22599560,
      "node_id": "MDQ6VXNlcjIyNTk5NTYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/22599560?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kevin-bates",
      "html_url": "https://github.com/kevin-bates",
      "followers_url": "https://api.github.com/users/kevin-bates/followers",
      "following_url": "https://api.github.com/users/kevin-bates/following{/other_user}",
      "gists_url": "https://api.github.com/users/kevin-bates/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kevin-bates/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kevin-bates/subscriptions",
      "organizations_url": "https://api.github.com/users/kevin-bates/orgs",
      "repos_url": "https://api.github.com/users/kevin-bates/repos",
      "events_url": "https://api.github.com/users/kevin-bates/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kevin-bates/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-02T16:13:13Z",
    "updated_at": "2020-10-02T16:13:13Z",
    "author_association": "MEMBER",
    "body": "I see - thank you.\r\n\r\nI think I'd feel better about this if we take the approach you propose but fall back to the current implementation (along with the change to close the handle) within an `except` block.  Does that sound okay?",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/702825627",
    "html_url": "https://github.com/jupyter/notebook/pull/5789#issuecomment-702825627",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/5789",
    "id": 702825627,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMjgyNTYyNw==",
    "user": {
      "login": "mueslo",
      "id": 847751,
      "node_id": "MDQ6VXNlcjg0Nzc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/847751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mueslo",
      "html_url": "https://github.com/mueslo",
      "followers_url": "https://api.github.com/users/mueslo/followers",
      "following_url": "https://api.github.com/users/mueslo/following{/other_user}",
      "gists_url": "https://api.github.com/users/mueslo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mueslo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mueslo/subscriptions",
      "organizations_url": "https://api.github.com/users/mueslo/orgs",
      "repos_url": "https://api.github.com/users/mueslo/repos",
      "events_url": "https://api.github.com/users/mueslo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mueslo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-02T16:17:25Z",
    "updated_at": "2020-10-02T16:28:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think simply adding the handle check should be good enough. `psutil` also makes sure to close the handle in its usage: https://github.com/giampaolo/psutil/blob/994c429c010049a6a0556ce3b0d1af1f86f27867/psutil/arch/windows/process_utils.c#L145-L171\r\n\r\nI will continue to run an unpatched version for now. If it occurs the next time, I will try to close the handle I receive, and then re-run OpenProcess. However, if some *other* process is leaking handles except jupyter, maybe you would have to 1. get the handle, 2. close the handle, 3. try to get the handle again (and 4. close it if it succeeds)? Hopefully these handles don't work like that, since there could be a large number of leaked handles. I hope handles are given out per requesting process.",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/702832528",
    "html_url": "https://github.com/jupyter/notebook/pull/5789#issuecomment-702832528",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/5789",
    "id": 702832528,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMjgzMjUyOA==",
    "user": {
      "login": "mueslo",
      "id": 847751,
      "node_id": "MDQ6VXNlcjg0Nzc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/847751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mueslo",
      "html_url": "https://github.com/mueslo",
      "followers_url": "https://api.github.com/users/mueslo/followers",
      "following_url": "https://api.github.com/users/mueslo/following{/other_user}",
      "gists_url": "https://api.github.com/users/mueslo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mueslo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mueslo/subscriptions",
      "organizations_url": "https://api.github.com/users/mueslo/orgs",
      "repos_url": "https://api.github.com/users/mueslo/repos",
      "events_url": "https://api.github.com/users/mueslo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mueslo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-02T16:31:23Z",
    "updated_at": "2020-10-02T16:31:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "https://github.com/giampaolo/psutil/blob/994c429c010049a6a0556ce3b0d1af1f86f27867/psutil/arch/windows/process_utils.c#L77-L79 very relevant\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/702845436",
    "html_url": "https://github.com/jupyter/notebook/pull/5789#issuecomment-702845436",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/5789",
    "id": 702845436,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMjg0NTQzNg==",
    "user": {
      "login": "mueslo",
      "id": 847751,
      "node_id": "MDQ6VXNlcjg0Nzc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/847751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mueslo",
      "html_url": "https://github.com/mueslo",
      "followers_url": "https://api.github.com/users/mueslo/followers",
      "following_url": "https://api.github.com/users/mueslo/following{/other_user}",
      "gists_url": "https://api.github.com/users/mueslo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mueslo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mueslo/subscriptions",
      "organizations_url": "https://api.github.com/users/mueslo/orgs",
      "repos_url": "https://api.github.com/users/mueslo/repos",
      "events_url": "https://api.github.com/users/mueslo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mueslo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-02T16:58:14Z",
    "updated_at": "2020-10-02T16:58:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "Okay, so I've managed to partially reproduce it.\r\n\r\n1. `nbopen /path1/notebook1.ipynb`\r\n2. `nbopen /path2/notebook2.ipynb`\r\n3. kill notebook server 1\r\n4. `jupyter notebook list` shows both notebooks running\r\n\r\nHowever, this does not fully reproduce my problem. I had *no* running notebooks left (which could be holding onto the handle). In the above case, it's obviously the Python process from step 2 which has a reference to the handle. In my case, I had killed all Python processes and it still would not work correctly.\r\n\r\nAnyway, this specific case *is* fixed by releasing the handle properly.",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/702944389",
    "html_url": "https://github.com/jupyter/notebook/pull/5789#issuecomment-702944389",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/5789",
    "id": 702944389,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMjk0NDM4OQ==",
    "user": {
      "login": "mueslo",
      "id": 847751,
      "node_id": "MDQ6VXNlcjg0Nzc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/847751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mueslo",
      "html_url": "https://github.com/mueslo",
      "followers_url": "https://api.github.com/users/mueslo/followers",
      "following_url": "https://api.github.com/users/mueslo/following{/other_user}",
      "gists_url": "https://api.github.com/users/mueslo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mueslo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mueslo/subscriptions",
      "organizations_url": "https://api.github.com/users/mueslo/orgs",
      "repos_url": "https://api.github.com/users/mueslo/repos",
      "events_url": "https://api.github.com/users/mueslo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mueslo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-02T20:31:48Z",
    "updated_at": "2020-10-02T20:31:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "See also #5791 for a possible psutil change",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/jupyter/notebook/issues/comments/704995726",
    "html_url": "https://github.com/jupyter/notebook/pull/5789#issuecomment-704995726",
    "issue_url": "https://api.github.com/repos/jupyter/notebook/issues/5789",
    "id": 704995726,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDk5NTcyNg==",
    "user": {
      "login": "kevin-bates",
      "id": 22599560,
      "node_id": "MDQ6VXNlcjIyNTk5NTYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/22599560?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kevin-bates",
      "html_url": "https://github.com/kevin-bates",
      "followers_url": "https://api.github.com/users/kevin-bates/followers",
      "following_url": "https://api.github.com/users/kevin-bates/following{/other_user}",
      "gists_url": "https://api.github.com/users/kevin-bates/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kevin-bates/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kevin-bates/subscriptions",
      "organizations_url": "https://api.github.com/users/kevin-bates/orgs",
      "repos_url": "https://api.github.com/users/kevin-bates/repos",
      "events_url": "https://api.github.com/users/kevin-bates/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kevin-bates/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-07T15:00:22Z",
    "updated_at": "2020-10-07T15:00:22Z",
    "author_association": "MEMBER",
    "body": "Hi @mueslo - thank you for the contribution.  I think this change is sufficient over the psutil-based change.",
    "performed_via_github_app": null
  }
]
